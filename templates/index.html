{% extends 'base.html' %}
{% block title %}ูุฑู ุจุฑูุงูู ุจุฏูุณุงุฒ{% endblock title %}

  {% block content %}
  <div class="container">
    <!-- ุณูุช ูุฑู -->
    <div class="form-box">
      <h2>๐ ูุฑู ุจุฑูุงูู ุงุฎุชุตุงุต</h2>
      <div class="progress"><div class="progress-bar"></div></div>

      <form id="fitnessForm" action="."  method="post">
        <!-- Step 1 -->
        <div class="step active">
          <label>ูุงู ู ูุงู ุฎุงููุงุฏฺฏ *</label>
          <input type="text" name="full_name" value="{{name}}" required>
        </div>
        <!-- Step 2 -->
        <div class="step">
          <label>ุณู *</label>
          <input type="number" name="age" min="10" max="85" required>
        </div>
        <!-- Step 3 -->
        <div class="step">
          <label>ูุฏ (ุณุงูุชโูุชุฑ) *</label>
          <input type="number" name="height" min="100" max="230" required>
        </div>
        <!-- Step 4 -->
        <div class="step">
          <label>ูุฒู (ฺฉููฺฏุฑู) *</label>
          <input type="number" name="weight" min="35" max="220" required>
        </div>
        <!-- Step 5 -->
        <div class="step">
          <label>ูุฏู ุงุตู *</label>
          <select name="goal" required>
            <option value="">ุงูุชุฎุงุจ ฺฉูุฏ</option>
            <option value="ฺฉุงูุด ุฒู">ฺฉุงูุด ูุฒู</option>
            <option>ุงูุฒุงุด ุนุถูู</option>
            <option>ูุฏุฑุช ุจุดุชุฑ</option>
            <option>ุณูุงูุช ุนููู</option>
          </select>
        </div>
        <!-- Step 6 -->
        <div class="step">
          <label>ฺูุฏ ุฑูุฒ ุฏุฑ ููุชู ูโุชูู ุชูุฑู ฺฉูุ *</label>
          <select name="days" required>
            <option value="">ุงูุชุฎุงุจ ฺฉูุฏ</option>
            <option>ฑ ุฑูุฒ</option>
            <option>ฒ ุฑูุฒ</option>
            <option>ณ ุฑูุฒ</option>
            <option>ด ุฑูุฒ</option>
            <option>ต ุฑูุฒ</option>
            <option>ถ ุฑูุฒ</option>
            <option>ท ุฑูุฒ</option>
          </select>
        </div>
        <!-- Step 7 -->
        <div class="step">
          ูพุณ ุงุฒ ุฒุฏู ุฒู ุฏฺฉูู ุฏุฑุฎูุงุณุช ุจุฑูุงูู ุจู ุตูุญู ูพุฑุฏุงุฎุช ููุชูู ู ุดูุฏ ูพุณ ุงุฒ ูพุฑุฏุงุฎุช ูพุงูฺฉ ูุงู ุงุทูุงุนุงุช ุจุฑูุงูู ุจู ุดูุงุฑู ุดูุง ุงุฑุณุงู ุฎูุงูุฏ ุดุฏ
        </div>

        <!-- Buttons -->
        <div class="btns">
          <button type="button" id="prevBtn">ูุจู</button>
          <button type="button" id="nextBtn">ุจุนุฏ</button>
        </div>
      </form>
    </div>

    <!-- ุณูุช ุชุตูุฑ -->
    <div class="image-side"></div>
  </div>
  <div class="loading-box">
    <span class="loader"></span>
  </div>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script>
    let currentStep = 0;
    const steps = $(".step");
    const progressBar = $(".progress-bar");

    function showStep(n) {
      steps.removeClass("active").eq(n).addClass("active");
      progressBar.css("width", ((n+1)/steps.length*100) + "%");
      $("#prevBtn").toggle(n>0);

      $("#nextBtn").text(n===steps.length-1 ? "ุจุฑูุงูู ูู ุฑู ุจุณุงุฒ" : "ุจุนุฏ");
    }

    showStep(currentStep);

    $("#nextBtn").click(function() {
      const currentInput = steps.eq(currentStep).find("input, select")[0];

      // ุงฺฏุฑ ููุฏ ูุฌูุฏ ุฏุงุดุช ู ูุงูุนุชุจุฑ ุจูุฏ
      if (currentInput && !currentInput.checkValidity()) {
        // ูพุงฺฉ ฺฉุฑุฏู ุฎุทุงูุง ูุจู ููุท ุจุฑุง ููู ููุฏ
        $(currentInput).siblings(".error-text").remove();
        $(currentInput).addClass("error");

        // ููุท ุงฺฏุฑ ูพุงู ุฎุทุง ูุฌูุฏ ูุฏุงุฑูุ ุจุณุงุฒ
        if ($(currentInput).siblings(".error-text").length === 0) {
          $(currentInput).after("<div class='error-text'>ูุทูุง ุงู ูุณูุช ุฑุง ฺฉุงูู ฺฉูุฏ</div>");
        }
        return; // ูุฐุงุฑู ุจุฑู ูุฑุญูู ุจุนุฏ
      }

      // ุงฺฏุฑ ูุนุชุจุฑ ุจูุฏ ุฎุทุง ุฑู ูพุงฺฉ ฺฉูู
      $(currentInput).removeClass("error");
      $(currentInput).siblings(".error-text").remove();
      $(".loading-box").removeClass("loading-box-active")

      if(currentStep < steps.length-1){
        currentStep++;
        showStep(currentStep);
      } else {
        /*alert("๐ ุงุทูุงุนุงุช ุดูุง ุซุจุช ุดุฏ!");
        $("#fitnessForm")[0].reset();*/
        $("#fitnessForm").submit();
        $(".loading-box").addClass("loading-box-active")
        currentStep = 0;
        showStep(currentStep);
      }
    });

    $("#prevBtn").click(function() {
      if(currentStep > 0){
        currentStep--;
        showStep(currentStep);
      }
    });


  </script>

{% endblock content %}